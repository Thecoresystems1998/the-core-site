<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>THE CORE.</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="slider">

<!-- SLIDE 1 — HERO -->

<section class="slide logo-slide">

  <img src="images/logo.jpg" class="core-logo-img">

  <div class="hero-tagline">
    DISCIPLINE • DANGER • FOCUS
  </div>

</section>

<!-- SLIDE 2 — OBJECT -->

<section class="slide">

  <img src="images/hero.jpg" class="object-hero">

  <button class="btn" onclick="openReservePanel()">
    RESERVE ENTRY
  </button>

</section>

<!-- SLIDE 3 — ARCHIVE -->

<section class="slide">

  <div class="title">ARCHIVE ACTIVATION</div>

  <div class="card">
    <div class="sub">
      NFC verification required<br>
      Registered object required
    </div>
    <div class="lock-bar"></div>
  </div>

</section>

<!-- SLIDE 4 — MEMBER -->

<section class="slide">

  <div class="title">MEMBER SPACE — PREVIEW</div>

  <div class="member-grid">
    <div class="member-tile">ENTRY</div>
    <div class="member-tile">ARCHIVE</div>
    <div class="member-tile">STATUS</div>
    <div class="member-tile">ACCESS</div>
    <div class="member-tile">RECORD</div>
    <div class="member-tile">CORE</div>
  </div>

</section>

</div>

<!-- =====================
     RESERVE PANEL
===================== -->

<div class="reserve-overlay" id="reservePanel">

  <div class="reserve-box">

    <div class="reserve-title">
      SYSTEM RESERVATION
    </div>

    <input
      type="email"
      id="reserveEmail"
      placeholder="email"
      class="reserve-input"
    >

    <button class="btn" onclick="submitReserve()">
      CONFIRM
    </button>

    <div class="reserve-status" id="reserveStatus"></div>

    <button class="reserve-close" onclick="closeReservePanel()">
      ×
    </button>

  </div>

</div>

<script>

/* PANEL */

function openReservePanel(){
  document.getElementById("reservePanel").classList.add("active");
}

function closeReservePanel(){
  document.getElementById("reservePanel").classList.remove("active");
}

/* RESERVE CALL — PORT 4000 */

async function submitReserve(){

  const email = document.getElementById("reserveEmail").value;
  const status = document.getElementById("reserveStatus");

  if(!email){
    status.innerText = "EMAIL REQUIRED";
    return;
  }

  status.innerText = "PROCESSING";

  try {

    const r = await fetch("http://localhost:4000/reserve", {
      method:"POST",
      headers:{ "Content-Type":"application/json"},
      body: JSON.stringify({ email })
    });

    const data = await r.json();

    if(data.status === "reserved"){
      status.innerText = "RESERVED — POSITION " + data.position;
    }
    else if(data.status === "full"){
      status.innerText = "EDITION FULL";
    }
    else if(data.error){
      status.innerText = data.error.toUpperCase();
    }
    else {
      status.innerText = "FAILED";
    }

  } catch(e){
    status.innerText = "SERVER ERROR";
  }

}

</script>

</body>
</html>